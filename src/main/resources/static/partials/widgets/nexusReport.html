<spectrum-widget-loading widget="widget" ready="ready || widgetOptionsActive"></spectrum-widget-loading>
<div ng-if="ready || widgetOptionsActive">
	<div class="widget-options" ng-if="widget.id !== undefined">
		<a role="button" ng-if="!widgetOptionsActive" id="configure-widget-{{widget.id}}" ng-click="showWidgetConfigModal()">
			<i class="glyphicon glyphicon-cog"></i>
		</a>
	</div>

    <div style="postion: relative; float: left; width: 100%;">

        <div ng-if="errorStatus !== null && (errorStatus === 404 || errorStatus === 500)" class="spec-help-class ng-scope alert alert-warning" id="info-spec-{{widget.id}}-notfound-message">
            <span class="glyphicon glyphicon-warning-sign"></span>
            NexusIQ cannot be found or it's not configured. Please configure Nexus or contact an Administrator
        </div>

        <div ng-if="errorStatus !== null && errorStatus === 401" class="spec-help-class ng-scope alert alert-warning" id="info-spec-{{widget.id}}-unauthorised-message">
            <span class="glyphicon glyphicon-warning-sign"></span>
            NexusIQ cannot validate your credentials. Please navigate to the <a href="account">Account</a> page and configure your credentials.
        </div>

        <div ng-if="!hasResults" class="spec-help-class ng-scope alert alert-info" id="info-spec-{{widget.id}}-empty-message">
            <span class="glyphicon glyphicon-info-sign"></span>
            No Results
        </div>

        <div class="well well-sm" ng-repeat="nexusApp in nexusApps" ng-if="nexusApp.hasResults">
            <div class="row row-special">
                <div class="col-lg-2 col-full">
                    <p>{{nexusApp.name}}</p>
                </div>
                <div class="col-lg-10 col-full">

                    <div class="row" ng-if="nexusApp.showSecurityData" ng-repeat="report in nexusApp.reports" ng-if="report.selected">
                        <div class="col-lg-3">
                            <p ng-hide="!$first" >Security</p>
                        </div>
                        <div class="col-lg-9 col-full" >
                            <div class="row row-indent">
                                <div class="col-lg-4 col-xs-4">
                                    <p><a href="{{report.reportLinkUrl}}" target="_blank">{{report.stage}}</a></p>
                                </div>
                                <div class="col-lg-2 col-xs-2" ng-repeat="issues in report.securityIssues">
                                    <span class="label nexus-label-{{issues.categoryName}}" ><span class="nexus-threat-label-value">{{issues.total}}</span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row" ng-if="nexusApp.showLicenseData" ng-repeat="report in nexusApp.reports" ng-if="report.selected" >
                        <div class="col-lg-3 col-full">
                            <p ng-hide="!$first" >License</p>
                        </div>
                        <div class="col-lg-9 col-full" >
                            <div class="row row-indent">
                                <div class="col-lg-4 col-xs-4">
                                    <p><a href="{{report.reportLinkUrl}}" target="_blank">{{report.stage}}</a></p>
                                </div>

                                <div class="col-lg-2 col-xs-2" ng-repeat="issues in report.effectiveLicenseThreats">
                                    <span class="label nexus-label-{{issues.categoryName}}" ><span class="nexus-threat-label-value">{{issues.total}}</span></span>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>

	<!--{{showConfigModal}}-->
    <div class="modal" id="widget-modal-{{widget.id}}">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Nexus Evaluations Reports Configuration</h4>
                </div>
                <div class="modal-body height-adjusting-modal">

                    <div class="well well-m">
                        <form role="form" name="configEditForm" class="form-horizontal">
                            <spectrum-widget-common-options widget="widget" data="data" form="configEditForm"></spectrum-widget-common-options>
                        </form>
                    </div>

                    <div class="well well-m" ng-repeat="nexusApp in nexusApps"  ng-class-odd="'odd'" ng-class-even="'even'">

                        <div class="row">
	                        <div class="col-lg-2">
                                <div class="material-switch pull-right">
                                    <input id="widget-config-{{nexusApp.name}}-{{widget.id}}" name="widget-config-{{nexusApp.name}}-{{widget.id}}" class="input-sm" ng-model="nexusApp.selected" ng-checked={{nexusApp.selected}}  type="checkbox" />
                                    <label for="widget-config-{{nexusApp.name}}-{{widget.id}}" class="label-success"></label>
                                </div>
	                        </div>

                            <div class="col-lg-3">
                                <label for="widget-config-{{nexusApp.name}}-{{widget.id}}" style="cursor:pointer; word-break:normal;">{{nexusApp.name}}</label>
                            </div>

                            <div class="col-lg-4">
                                <select data-placeholder="Choose State" class="chosen-select" multiple="" ng-model="nexusApp.selectedStages">
                                    <option ng-repeat="report in nexusApp.reports" value="{{report.stage}}" data-ng-selected="{{report.selected}}">{{report.stage}}</option>
                                </select>
                            </div>

                            <div class="col-lg-3">
                                <div class="checkbox checkbox-info checkbox-circle">
                                    <input id="widget-ner-config-showLicenseData-{{nexusApp.name}}-{{widget.id}}" class="" style="margin-left: 0px;" ng-model="nexusApp.showLicenseData" ng-checked={{nexusApp.showLicenseData}}  type="checkbox" />
                                    <label for="widget-ner-config-showLicenseData-{{nexusApp.name}}-{{widget.id}}">License</label>
                                </div>

                                <div class="checkbox checkbox-info checkbox-circle">
                                    <input id="widget-ner-config-showSecurityData-{{nexusApp.name}}-{{widget.id}}" class="" style="margin-left: 0px;" ng-model="nexusApp.showSecurityData" ng-checked={{nexusApp.showSecurityData}}  type="checkbox" />
                                    <label for="widget-ner-config-showSecurityData-{{nexusApp.name}}-{{widget.id}}">Security</label>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" ng-click="cancelOptions()">Cancel</button>
                    <button type="button" class="btn btn-primary" ng-click="saveNexusConfig(nexusApps)">Save</button>
                </div>
            </div>
        </div>
    </div>

</div>
