<spectrum-heading title="{{process.title}}" subtitle="Versions"></spectrum-heading>
<div class="container theme-showcase" role="main">
	<div class="alert alert-danger" role="alert" ng-if="error">
		<span class="glyphicon glyphicon-exclamation-sign"></span>
		{{error}}
	</div>
	<div ng-if="error === undefined">

		<spectrum-table id="tb-spec-process-versions"
						add-actions="addActions"
						add-actions-title="Add a new version"
						headings="[{icon: ''},
						           {versionKey: 'Version'},
						           {comment: 'Version comment'},
						           {description: 'Version description'},
						           {createDate: 'Date created'},
						           {createdBy: 'Created By'},
						           {updateDate: 'Date updated'},
						           {updatedBy: 'Updated By'}]"
						rows="processRowModel.rows"
						orderable-columns=""
						order-reverse-initial="true"
						order-by-initial="sequence"
						empty-message="No process versions found."
						popover-rules="{versionKey: {cutoff: '8', placement: 'right', suffix: ''}}"
						filterable="true"
						filterable-columns="['comment','description']"
						filter-prompt="Search versions"
						filter-applied="processRowModel.filterApplied"
						update-in-progress="processRowModel.updateInProgress"
						row-description-plural="versions"
						elements-total-length="processRowModel.rows.totalLength">
		</spectrum-table>
		<div class="modal fade" id="cloneProcessVersionModal" tabindex="-1"
			 role="dialog" aria-labelledby="cloneProcessVersionModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
								aria-hidden="true">&times;</button>
						<h4 class="modal-title">Clone to new process</h4>
					</div>
					<div class="modal-body">
						<div id="error" class="alert alert-danger" role="alert" ng-if="createProcess.error">
							<span class="glyphicon glyphicon-exclamation-sign"></span>
							{{createProcess.error}}
						</div>
						<form class="form-horizontal" ng-submit="submitCreateProcess()">
							<div class="form-group">
								<label for="txt-spec-process-title" class="col-sm-4 control-label">
									Process title
								</label>
								<div class="col-sm-8">
									<input type="text" class="form-control" id="txt-spec-process-title"
									       placeholder="Add a title..." ng-model="createProcess.targetProcess.title"/>
								</div>
							</div>
							<div class="form-group">
								<label for="txt-spec-process-description" class="col-sm-4 control-label">
									Process description
								</label>
								<div class="col-sm-8">
									<textarea class="form-control spec-textarea" id="txt-spec-process-description"
									          placeholder="Add a description..." rows="4" wrap="virtual"
									          ng-model="createProcess.targetProcess.description">
									</textarea>
								</div>
							</div>
							<hr>
							<div class="form-group">
								<label for="txt-spec-process-version-comment" class="col-sm-4 control-label">
									Version
								</label>
								<div class="col-sm-8">
									<input type="text" class="form-control" id="txt-spec-process-version-key"
									       ng-model="createProcess.sourceProcessVersion.versionKey" disabled/>
								</div>
							</div>
							<div class="form-group">
								<label for="txt-spec-process-version-comment" class="col-sm-4 control-label">
									Version comment
								</label>
								<div class="col-sm-8">
									<textarea class="form-control spec-textarea" id="txt-spec-process-version-comment"
											  rows="4" wrap="virtual" ng-model="createProcess.sourceProcessVersion.comment"
											  disabled>
									</textarea>
								</div>
							</div>
							<div class="form-group">
								<label for="txt-spec-process-version-description" class="col-sm-4 control-label">
									Version description
								</label>
								<div class="col-sm-8">
									<textarea class="form-control spec-textarea" id="txt-spec-process-version-description"
									          rows="4" wrap="virtual" ng-model="createProcess.sourceProcessVersion.description"
									          disabled>
									</textarea>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<button id="btn-spec-new-process-from-version-create"
											class="btn btn-primary pull-right" type="submit">
										<span class="glyphicon glyphicon-ok"></span>
										Create
									</button>
									<button id="btn-spec-new-process-from-version-cancel" class="btn btn-default pull-right"
											data-dismiss="modal" style="margin-right: 10px;">
										<span class="glyphicon glyphicon-stop"></span>
										Cancel
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="compareVersionsModal" tabindex="-1"
		     role="dialog" aria-labelledby="compareVersionsModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
						        aria-hidden="true">&times;</button>
						<h4 class="modal-title">Compare to another version</h4>
					</div>
					<div class="modal-body">
						<div class="alert alert-danger" role="alert" ng-if="compareVersions.error">
							<span class="glyphicon glyphicon-exclamation-sign"></span>
							{{compareVersions.error}}
						</div>
						<form class="form-horizontal" ng-submit="submitCompareVersions()">
							<div class="form-group">
								<label for="select-spec-compare-to-process-version" class="col-sm-3 control-label">
									Compare with
								</label>
								<div class="col-sm-9">
									<select class="form-control" id="select-spec-compare-to-process-version"
									        ng-model="compareVersions.targetProcessVersion"
									        ng-change="processSelectedCompareVersion()"
									        ng-options="version.comment + ' (' + version.versionKey.substring(0, 8) + ')'
									                for version in compareVersions.targetProcessVersions | orderBy:'sequence':true">
									</select>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<button id="btn-spec-compare-process-version" class="btn btn-primary pull-right"
									        type="submit"
									        ng-disabled="compareVersions.targetProcessVersion === undefined">
										<span class="glyphicon glyphicon-new-window"></span>
										Compare
									</button>
									<button id="btn-spec-compare-process-version-cancel"
									        class="btn btn-default pull-right"
									        data-dismiss="modal" style="margin-right: 10px;">
										<span class="glyphicon glyphicon-stop"></span>
										Cancel
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="moveVersionModal" tabindex="-1"
			 role="dialog" aria-labelledby="moveVersionModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
								aria-hidden="true">&times;</button>
						<h4 class="modal-title">Move to existing process</h4>
					</div>
					<div class="modal-body">
						<div class="alert alert-danger" role="alert" ng-if="moveVersion.error">
							<span class="glyphicon glyphicon-exclamation-sign"></span>
							{{moveVersion.error}}
						</div>
						<form class="form-horizontal" ng-submit="submitMoveVersion()">
							<div class="form-group">
								<label for="select-spec-move-to-process" class="col-sm-3 control-label">
									Move to
								</label>
								<div class="col-sm-9">
									<select class="form-control" id="select-spec-move-to-process"
											ng-model="moveVersion.targetProcess"
											ng-change="processSelectedMoveVersion()"
											ng-options="process.title for process in moveVersion.targetProcesses | orderBy:'title'">
									</select>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<button id="btn-spec-move-process" class="btn btn-primary pull-right" type="submit"
											ng-disabled="moveVersion.targetProcess === undefined">
										<span class="glyphicon glyphicon-new-window"></span>
										Move
									</button>
									<button id="btn-spec-move-process-cancel" class="btn btn-default pull-right"
											data-dismiss="modal" style="margin-right: 10px;">
										<span class="glyphicon glyphicon-stop"></span>
										Cancel
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
